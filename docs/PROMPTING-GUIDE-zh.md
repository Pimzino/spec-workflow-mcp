# 提示指南

通过 AI 助手与 Spec Workflow MCP 交互的示例和最佳实践的综合指南。

## 快速参考

### 基本命令

```
"为 [功能] 创建规范"
"列出我所有的规范"
"显示 [规范名称] 的状态"
"从 [规范] 实现任务 [编号]"
"创建指导文档"
```

## 创建规范

### 基本规范创建

#### 简单请求
```
"为用户认证创建规范"
```

AI 将创建：
- 需求文档
- 设计文档（批准后）
- 任务分解（设计批准后）

#### 详细请求
```
"创建名为 payment-processing 的规范，包含：
- 通过 Stripe 的信用卡支付
- PayPal 集成
- 退款处理
- 支付事件的 Webhook 处理
- PCI 合规性考虑"
```

#### 从现有文档创建
```
"从 @product-requirements.md 中的 PRD 创建规范"
```

```
"基于 @figma-export.md 中的设计文档构建规范"
```

### 高级规范创建

#### 带技术约束
```
"为实时通知创建规范，要求：
- 使用 WebSocket 进行实时更新
- 为旧版浏览器回退到轮询
- 处理最多 10,000 个并发连接
- 保持消息顺序
- 包含离线队列支持"
```

#### 带验收标准
```
"为搜索功能创建规范，包含以下验收标准：
- 结果在 200ms 内显示
- 支持模糊匹配
- 包含日期、类别和作者的过滤器
- 显示相关性评分
- 处理拼写错误和同义词"
```

#### 微服务规范
```
"为库存微服务创建规范，要求：
- 公开 REST API
- 使用 PostgreSQL 存储
- 向 Kafka 发布事件
- 实现 CQRS 模式
- 包含健康检查端点"
```

## 管理规范

### 列表和状态

#### 获取概览
```
"列出我所有的规范"
"显示所有规范及其进度"
"哪些规范正在等待批准？"
"哪些规范当前正在进行中？"
```

#### 特定状态
```
"显示 user-auth 规范的状态"
"payment-processing 的进度如何？"
"显示通知规范中还剩什么要做"
"user-profile 中哪些任务已完成？"
```

#### 过滤
```
"显示完成度超过 50% 的规范"
"列出等待我批准的规范"
"哪些规范还没有完成任何任务？"
"显示被阻塞或卡住的规范"
```

### 文档管理

#### 查看文档
```
"显示 user-auth 的需求"
"显示支付的设计文档"
"通知系统的任务是什么？"
"显示搜索规范的所有文档"
```

#### 更新文档
```
"更新 user-auth 需求以包含 2FA"
"修订支付设计以使用 Stripe Connect"
"为 user-profile 添加安全测试任务"
"根据反馈更新需求：[反馈]"
```

## 实现提示

### 单个任务

#### 基本实现
```
"从 user-auth 实现任务 1.2"
"完成支付规范中的任务 2.1.3"
"处理通知中的下一个待处理任务"
```

#### 带上下文
```
"使用 TypeScript 和 Express 从 user-auth 实现任务 1.2"
"使用 Prisma 完成数据库迁移任务"
"遵循 REST 约定实现 API 端点任务"
```

### 批量实现

#### 按部分
```
"从 user-auth 实现所有数据库任务"
"完成仪表板规范中的所有前端任务"
"处理支付的所有 API 任务"
```

#### 按优先级
```
"首先实现所有关键任务"
"完成 user-profile 的 MVP 任务"
"专注于演示所需的任务"
```

#### 顺序
```
"从 user-auth 实现任务 1.1 到 1.5"
"完成第 2 部分下的所有子任务"
"按顺序完成设置任务"
```

### 实现策略

#### 测试驱动
```
"对于任务 1.2，先写测试然后实现"
"实现任务 2.1 并完整测试覆盖"
"实现服务任务时创建单元测试"
```

#### 带文档
```
"实现任务 1.3 并记录 API"
"完成认证任务并添加内联注释"
"实现任务 2.2 并创建使用示例"
```

## 指导文档

### 创建指导

#### 完整集合
```
"为我的电商项目创建指导文档"
"为 SaaS 应用程序设置指导"
"为移动应用创建项目指导"
```

#### 单个文档
```
"创建专注于用户体验的产品指导文档"
"为微服务架构创建技术指导"
"为 monorepo 设置创建结构指导"
```

#### 从上下文
```
"基于 @project-brief.md 创建指导文档"
"从 @architecture.md 中的技术决策生成指导"
```

### 更新指导

```
"更新产品指导以包含 B2B 功能"
"修订技术指导以使用 GraphQL 而不是 REST"
"更新新模块系统的结构指导"
```

## 审批工作流

### 请求反馈

#### 带特定关注点
```
"请求批准 user-auth 需求 - 特别检查安全部分"
"要求审查支付设计 - 关注错误处理"
"请求对任务分解的反馈 - 是否过于细化？"
```

#### 修订请求
```
"需求需要更多关于以下方面的细节：
- 错误处理场景
- 性能要求
- 安全考虑
请修订并重新提交"
```

### 审批决策

#### 批准
```
"批准 user-auth 需求"
"设计看起来不错，批准它"
"接受任务分解原样"
```

#### 请求更改
```
"请求对需求进行更改：
- 添加多租户支持
- 包含速率限制
- 指定数据保留政策"
```

#### 拒绝
```
"拒绝当前设计 - 我们需要改用事件驱动架构"
"从需求重新开始 - 范围太广"
```

## Bug 工作流

### 报告 Bug

#### 详细报告
```
"创建 bug 报告：
标题：使用特殊字符登录失败
步骤：1) 输入带 '+' 的电子邮件 2) 提交表单 3) 看到错误
预期：登录成功
实际：500 错误
优先级：高
环境：生产"
```

#### 从错误日志
```
"从此错误创建 bug 报告：[粘贴堆栈跟踪]"
"从 Sentry 警报记录此 bug：[链接]"
```

### Bug 解决

#### 调查
```
"调查 bug #45 的根本原因"
"分析支付 webhook 为什么失败"
"调试搜索端点中的性能问题"
```

#### 修复实现
```
"为用户认证中的 bug #45 创建修复"
"实现支付超时问题的解决方案"
"修复通知服务中的内存泄漏"
```

## 实现中的更改

### 开发期间规范变更时

需求和设计在实现过程中经常演变。发生这种情况时，你需要保持 tasks.md 与当前规范保持一致，同时保留已完成的工作。

### 使用任务刷新功能

AI 可以通过 refresh-tasks 提示访问全面的任务刷新说明。只需告知 AI 你的更改：

#### 基本任务刷新
```
"需求已更新。请刷新 tasks.md 以与当前的 requirements.md 和 design.md 对齐。"
```

#### 带上下文的详细任务刷新
```
"我已使用以下更改更新了规范：
- 删除了报告模块
- 将数据库从 MongoDB 更改为 PostgreSQL
- 添加了社交登录功能

请按照任务刷新流程刷新 tasks.md：
1. 保留所有已完成和进行中的任务
2. 为数据库更改添加迁移任务
3. 删除报告模块的待处理任务
4. 为社交登录添加新任务"
```

#### 需要迁移的架构更改
```
"我们正在从 REST API 切换到 GraphQL。一些 REST 端点已经实现。请更新 tasks.md：
1. 保留所有已完成的 REST 工作
2. 添加迁移任务以在 GraphQL resolver 中包装 REST 逻辑
3. 新的 GraphQL 实现任务
4. 在 GraphQL 验证后清理任务以删除 REST"
```

### 预期的 AI 行为

当你请求任务刷新时，AI 将：

1. **分析当前状态**
   - 读取 requirements.md 和 design.md 以获取当前规范
   - 识别已完成、进行中和待处理的任务
   - 确定添加、删除或更改了哪些功能

2. **保留已完成的工作**
   - 保持所有 [x] 已完成任务不变
   - 保持所有 [-] 进行中任务不变
   - 为已删除功能的已完成工作添加备注

3. **处理架构更改**
   - 在需要更新的已完成工作后添加迁移任务
   - 为渐进迁移创建过渡任务
   - 在删除旧实现之前包含验证任务

4. **更新待处理任务**
   - 删除已删除功能的待处理任务
   - 更新已更改需求的待处理任务
   - 为新功能添加新任务

5. **维护任务结构**
   - 保持顺序编号
   - 保留任务格式
   - 包含需求引用
   - 维护依赖顺序

### 示例场景

#### 功能删除
```
"我们决定从规范中删除报告模块。相应地更新 tasks.md。"
```

预期 AI 行为：
- 保留所有已完成的报告任务及其 [x] 状态
- 保留所有进行中的报告任务及其 [-] 状态
- 仅删除待处理的 [ ] 报告任务
- 添加备注："_备注：报告功能已从规范中删除，但保留了已完成的工作_"

#### 有已完成工作的架构更改
```
"我们正在从 MongoDB 切换到 PostgreSQL。更新待处理的数据库任务。注意我们已经实现了 MongoDB 模式和连接逻辑。"
```

预期 AI 行为：
- 完全按原样保留所有已完成的 MongoDB 任务
- 完全按原样保留所有进行中的 MongoDB 任务
- 在已完成的 MongoDB 工作后立即添加新的迁移任务：
  - 将 MongoDB 模式迁移到 PostgreSQL 表
  - 用 PostgreSQL 客户端替换 MongoDB 连接逻辑
  - 将数据库查询从 MongoDB 更新为 PostgreSQL 语法
  - 将现有 MongoDB 数据迁移到 PostgreSQL
  - 为 PostgreSQL 更新环境配置
  - 在验证迁移后删除 MongoDB 依赖项
- 更新剩余的待处理数据库任务以使用 PostgreSQL
- 维护任务编号序列

#### 功能添加
```
"为认证规范添加社交登录。需求和设计已更新。"
```

预期 AI 行为：
- 保留所有现有任务
- 在相关部分后添加新的社交登录任务
- 包括 OAuth 提供商集成
- 添加用户帐户链接任务
- 更新测试任务以涵盖社交登录

## 模板和自定义

### 使用模板

#### 获取所有模板
```
"显示所有文档模板"
"我可以使用哪些模板？"
```

#### 自定义模板
```
"修改需求模板以包含隐私部分"
"调整任务模板以包括工作量估算"
```

## 协作

### 团队工作流

#### 分配规范
```
"将 user-auth 规范分配给 @alice"
"@bob 将负责支付实现"
```

#### 状态更新
```
"更新团队：user-auth 需求已批准"
"通知设计审查已准备就绪"
```

### 审查请求

```
"请求 @senior-dev 审查架构设计"
"@tech-lead 请审查任务分解"
```

## 高级模式

### 依赖管理

```
"创建 session-management 规范，依赖于 user-auth"
"标记 payment-processing 阻塞在 database-setup 上"
```

### 版本控制

```
"为 user-auth 创建 v2 规范以进行重大重构"
"将支付规范分支用于 Stripe Connect 迁移"
```

### 里程碑

```
"创建 MVP 里程碑，包含 user-auth 和 basic-dashboard"
"定义包含所有支付功能的 beta 里程碑"
```

## 故障排除提示

### 当事情不按预期工作时

#### 规范问题
```
"user-auth 规范没有显示 - 帮我调试"
"任务文件损坏 - 如何恢复？"
"批准卡在待处理状态 - 发生了什么？"
```

#### 实现问题
```
"任务 1.2 比预期更复杂 - 我们应该分解它吗？"
"我们跳过了任务 1.3 - 如何重新排序？"
"此任务阻塞其他任务 - 更新依赖关系"
```

## 最佳实践

### 清晰的规范命名

**好的**：
```
"user-authentication"
"payment-processing"
"real-time-notifications"
```

**避免**：
```
"spec1"
"new-feature"
"updates"
```

### 描述性任务请求

**好的**：
```
"从 user-auth 实现任务 1.2：使用 bcrypt 创建密码哈希函数"
```

**避免**：
```
"做任务 1.2"
```

### 结构化反馈

**好的**：
```
"需求需要更改：
1. 添加 OAuth2 支持
2. 指定密码策略
3. 包括会话超时
4. 定义 2FA 流程"
```

**避免**：
```
"添加更多内容"
```

## 提示模式

### 探索性

```
"user-auth 规范中有什么？"
"我们对支付处理有哪些选项？"
"类似项目如何处理通知？"
```

### 决策性

```
"批准 user-auth 需求"
"将任务 1.2 标记为已完成"
"拒绝设计并要求修订"
```

### 迭代性

```
"更新需求基于此反馈..."
"修订设计以解决这些问题..."
"调整任务以适应新方法..."
```

## 相关文档

- [用户指南](USER-GUIDE.md) - 一般使用说明
- [工作流程](WORKFLOW.md) - 开发流程
- [工具参考](TOOLS-REFERENCE.md) - 可用工具
- [界面指南](INTERFACES.md) - 仪表板功能

